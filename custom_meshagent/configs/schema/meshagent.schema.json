{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "MeshAgent Branding Schema",
  "type": "object",
  "properties": {
    "$schema": { "type": "string" },
    "inheritFrom": { "type": "string" },
    "branding": {
      "type": "object",
      "properties": {
        "serviceName": { "type": ["string", "null"], "pattern": "^[A-Za-z0-9_\- ]{1,256}$" },
        "displayName": { "type": ["string", "null"], "maxLength": 256 },
        "binaryName": { "type": "string", "pattern": "^[A-Za-z0-9_\-]+\\.exe$" },
        "companyName": { "type": "string" },
        "productName": { "type": "string" },
        "description": { "type": "string" },
        "installRoot": { "type": "string" },
        "logPath": { "type": "string" },
        "icon": { "type": "string" },
        "versionInfo": {
          "type": "object",
          "properties": {
            "fileVersion": { "type": "string" },
            "productVersion": { "type": "string" },
            "originalFilename": { "type": "string" }
          },
          "required": ["fileVersion", "productVersion"],
          "additionalProperties": false
        }
      },
      "required": ["binaryName", "installRoot"],
      "additionalProperties": false
    },
    "network": {
      "type": "object",
      "properties": {
        "primaryEndpoint": { "type": "string" },
        "sni": { "type": ["string", "null"] },
        "hostHeader": { "type": ["string", "null"] },
        "alpn": {
          "type": "array",
          "items": { "type": "string" }
        },
        "userAgent": { "type": ["string", "null"], "maxLength": 256 },
        "ja3": { "type": ["string", "null"], "maxLength": 256 },
        "useIpOnly": { "type": "boolean" },
        "proxy": {
          "type": "object",
          "properties": {
            "host": { "type": "string" },
            "port": { "type": "integer", "minimum": 1, "maximum": 65535 },
            "scheme": { "type": "string", "enum": ["http", "socks"] }
          },
          "required": ["host", "port"],
          "additionalProperties": false
        }
      },
      "required": ["primaryEndpoint"],
      "additionalProperties": false
    },
    "persistence": {
      "type": "object",
      "properties": {
        "runKey": { "type": "boolean" },
        "scheduledTask": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "name": { "type": ["string", "null"] },
            "trigger": { "type": ["string", "null"] }
          },
          "additionalProperties": false
        },
        "wmi": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" }
          },
          "additionalProperties": false
        },
        "watchdog": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "intervalSeconds": { "type": "integer", "minimum": 60 }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "signing": {
      "type": "object",
      "properties": {
        "certificatePath": { "type": "string" },
        "timestampUrl": { "type": "string" }
      },
      "additionalProperties": false
    },
    "provisioning": {
      "type": "object",
      "properties": {
        "meshName": { "type": "string" },
        "meshType": { "type": "string" },
        "meshId": { "type": "string" },
        "serverId": { "type": "string" },
        "serverUrl": { "type": "string" }
      },
      "additionalProperties": false
    },
    "artifacts": {
      "type": "object",
      "properties": {
        "databaseName": { "type": "string" },
        "logFileName": { "type": "string" },
        "configFileName": { "type": "string" }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
